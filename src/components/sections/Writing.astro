---
import { getCollection } from 'astro:content';
import BlogPostLink from '../ui/BlogPostLink.astro';

interface Props {
  currentLang?: 'en' | 'pl';
}

const { currentLang = 'en' } = Astro.props;

const labels = currentLang === 'pl' ? {
  title: "Publikacje",
  subtitle: "Dzielę się wiedzą na temat programowania i architektury IT.",
  empty: "Jeszcze tu pusto, ale pracuję nad pierwszym artykułem!"
} : {
  title: "Writing",
  subtitle: "Sharing my knowledge about software engineering and IT architecture.",
  empty: "It's empty here for now, but I'm working on the first article!"
};

// Fetch blog posts and filter by current language, sorted by date descending
const allPosts = await getCollection('blog');
const posts = allPosts
  .filter(post => post.data.language === currentLang)
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());
---

<section id="writing" class="py-24 sm:py-32 bg-white ]">
  <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="mb-16">
      <h2 class="text-sm font-medium text-gray-500 tracking-wide uppercase mb-2">Writing</h2>
      <h3 class="text-3xl sm:text-4xl font-bold tracking-tight text-gray-900 ">Recent Articles</h3>
    </div>

    {posts.length > 0 ? (
      <div class="flex flex-col gap-2">
        {posts.map((post) => (
          <BlogPostLink post={post} lang={currentLang} />
        ))}
      </div>
    ) : (
      <div class="text-center py-12 px-4 rounded-xl border border-dashed border-gray-300 ">
        <p class="text-gray-500 ">{labels.empty}</p>
      </div>
    )}
  </div>
</section>
